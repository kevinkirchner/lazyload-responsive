/*! lazyload-responsive - v0.2.2 - 2013-05-05
* Copyright (c) 2013 Kevin Kirchner; Licensed BSD */
function contentLoaded(t,e){var a=!1,i=!0,r=t.document,n=r.documentElement,s=r.addEventListener?"addEventListener":"attachEvent",l=r.addEventListener?"removeEventListener":"detachEvent",o=r.addEventListener?"":"on",d=function(i){("readystatechange"!=i.type||"complete"==r.readyState)&&(("load"==i.type?t:r)[l](o+i.type,d,!1),!a&&(a=!0)&&e.call(t,i.type||i))},u=function(){try{n.doScroll("left")}catch(t){return setTimeout(u,50),void 0}d("poll")};if("complete"==r.readyState)e.call(t,"lazy");else{if(r.createEventObject&&n.doScroll){try{i=!t.frameElement}catch(g){}i&&u()}r[s](o+"DOMContentLoaded",d,!1),r[s](o+"readystatechange",d,!1),t[s](o+"load",d,!1)}}(function(t,e){var a={srcAttr:"data-lzld-src",offset:200,highResThreshold:1.5,throttleInterval:20,useGlobalImgConfig:!1,findSmallerImgs:!0,imgConfig:{highressuffix:"@2x",loadevent:["scroll","resize"],longfallback:!0,lowres:!1,sizedown:!1,widthfactor:200}},i=!1;contentLoaded(t,function(){i=!0});var r={_o:a,_f:{},imgs:[],loadImgsQ:[],loadedImgs:[],requestingBaseImgSrc:[],availableImgSrc:[],unavailableImgSrc:[],xmlhttp:[],initialize:function(){var t=this;t._f.isHighRes=t._u.getPixelRatio()>=t._o.highResThreshold,t.collectImgs(),t.loadImgs(),t.attachEvents()},collectImgs:function(){for(var t=this,a=e.getElementsByTagName("img"),i=0,r=a.length;r>i;i++)if(null!==a[i].getAttribute(t._o.srcAttr)){var n=a[i];-1===t._u.inArray(n,t.imgs)&&t.imgs.push(n),!n.getAttribute("data-lzld-complete")&&t._u.isVisible(n)&&t.loadImgsQ.push(n)}},loadImgs:function(){var t=this;t.loadImgsQ.reverse();for(var e=t.loadImgsQ.length-1;e>=0;e--){var a=t.loadImgsQ[e],i=t.getImgData(a);t.requestImg(i),t.loadImgsQ.splice(e,1)}},resizeImgs:function(){for(var t=this,e=0,a=t.loadedImgs.length;a>e;e++){var i=t.loadedImgs[e];i.aliasArray=t.getAliasArray(i._e.img,i._o)}},attachEvents:function(){var e=this,a=e._u.getViewport("Width"),i=e._u.throttle(function(){e.collectImgs(),e.loadImgs()},20),r=e._u.throttle(function(){e.resizeImgs()},20);e._u.addEvent(t,"resize",function(){var t=e._u.getViewport("Width");(e._o.findSmallerImgs||t>a)&&r(),t>a&&i(),a=t}),e._u.addEvent(t,"scroll",function(){i()})},getImgData:function(t){var e=this,a=e.getImgConfig(t),i=t.getAttribute("data-lzld-isparsed")?e.getStoredParsedImgSrc(t):e.getParsedImgSrc(t),r=e.getAliasArray(t,a),n={_e:{img:t},_o:a,_p:i,aliasArray:r};return n},getImgConfig:function(t){var e=this;return e._o.useGlobalImgConfig?e._o.imgConfig:{highressuffix:t.getAttribute("data-lzld-highressuffix")||e._o.imgConfig.highressuffix,loadevent:t.getAttribute("data-lzld-loadevent")||e._o.imgConfig.loadevent,longfallback:t.getAttribute("data-lzld-longfallback")||e._o.imgConfig.longfallback,lowres:t.getAttribute("data-lzld-lowres")||e._o.imgConfig.lowres,sizedown:t.getAttribute("data-lzld-sizedown")||e._o.imgConfig.sizedown,widthfactor:t.getAttribute("data-lzld-widthfactor")||e._o.imgConfig.widthfactor}},getStoredParsedImgSrc:function(t){return{filePath:t.getAttribute("data-lzld-filepath"),fileName:t.getAttribute("data-lzld-filename"),fileExt:t.getAttribute("data-lzld-fileext"),aliasBase:t.getAttribute("data-lzld-aliasbase"),baseSrc:t.getAttribute("data-lzld-basesrc")}},getParsedImgSrc:function(t){var e=this,a=t.getAttribute(e._o.srcAttr),i=a.lastIndexOf("/")+1,r=a.substring(0,i),n=a.substring(i),s=n.lastIndexOf("."),l=n.substring(0,s),o=n.substring(s);return t.setAttribute("data-lzld-filepath",r),t.setAttribute("data-lzld-filename",l),t.setAttribute("data-lzld-fileext",o),t.setAttribute("data-lzld-aliasbase",r+l),t.setAttribute("data-lzld-basesrc",r+l+o),t.setAttribute("data-lzld-isparsed","true"),{filePath:r,fileName:l,fileExt:o,aliasBase:r+l,baseSrc:r+l+o}},getAliasArray:function(t,e){var a=this,i=[],r=a._f.isHighRes&&!e.lowres,n=a._u.getViewport("Width"),s=Math.floor(n/e.widthfactor),l=e.sizedown?(s+1)*e.widthfactor:s*e.widthfactor;if(r&&i.push("_"+l+e.highressuffix),i.push("_"+l),e.longfallback)for(var o=s-1;o>=0;o--){var d=e.sizedown?(o+1)*e.widthfactor:o*e.widthfactor;d>0&&(r&&i.push("_"+d+e.highressuffix),i.push("_"+d))}return r&&i.push("_small"+e.highressuffix),i.push("_small"),r&&i.push(e.highressuffix),i.push(""),i},requestImg:function(t){var e=this;if(t.aliasArray.length&&-1===e._u.inArray(t._p.baseSrc,e.requestingBaseImgSrc)){var a=t._p.aliasBase+t.aliasArray[0]+t._p.fileExt;if(t.aliasArray.splice(0,1),e.requestingBaseImgSrc.push(t._p.baseSrc),-1!==e._u.inArray(a,e.availableImgSrc))return e.requestSuccess(a,t),void 0;-1!==e._u.inArray(a,e.unavailableImgSrc)?e.requestImg(t):e.sendImgRequest(a,t)}},sendImgRequest:function(e,a){var i=this,r=i.xmlhttp.length;i.xmlhttp[r]=t.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),i.xmlhttp[r].onreadystatechange=function(){4===i.xmlhttp[r].readyState&&(i.requestingBaseImgSrc.splice(i.requestingBaseImgSrc.indexOf(a._p.baseSrc),1),200===i.xmlhttp[r].status?(i.availableImgSrc.push(e),i.requestSuccess(e,a)):(i.unavailableImgSrc.push(e),i.requestImg(a)))},i.xmlhttp[r].open("GET",e,!1),i.xmlhttp[r].send()},requestSuccess:function(t,e){var a=this,i=e._e.img;i.src=t,a.loadedImgs.push(e)}};r._u={lzld:r,_o:a,throttle:function(t,e){var a=0;return function(){var i=+new Date;e>i-a||(a=i,t.apply(this,arguments))}},addEvent:function(e,a,i){e.attachEvent?(e["e"+a+i]=i,e[a+i]=function(){e["e"+a+i](t.event)},e.attachEvent("on"+a,e[a+i])):e.addEventListener(a,i,!1)},inArray:function(t,e,a){var i;if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t,a);for(i=e.length,a=a?0>a?Math.max(0,i+a):a:0;i>a;a++)if(a in e&&e[a]===t)return a}return-1},isVisible:function(t){var a=this,i=a.getViewport("Height");return a.contains(e.documentElement,t)&&t.getBoundingClientRect().top<i+a._o.offset},getViewport:function(a){return e.documentElement["client"+a]>=0?e.documentElement["client"+a]:e.body&&e.body["client"+a]>=0?e.body["client"+a]:t["inner"+a]>=0?t["inner"+a]:0},contains:function(t,a){if(e.documentElement.compareDocumentPosition)return!!(16&t.compareDocumentPosition(a));if(e.documentElement.contains)return t!==a&&(t.contains?t.contains(a):!1);for(;a=a.parentNode;)if(a===t)return!0;return!1},getPixelRatio:function(){return t.devicePixelRatio?t.devicePixelRatio:1}},t.LazyloadResponsive=r,i?t.LazyloadResponsive.initialize():contentLoaded(t,function(){t.LazyloadResponsive.initialize()})})(this,document);